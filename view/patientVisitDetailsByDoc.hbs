<html lang="en">
<head>
   <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="/assets/img/icon.png">
  <title>
    MediPoint - OPD Card Search
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <!-- Nucleo Icons -->
  <link href="/assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link id="pagestyle" href="/assets/css/argon-dashboard.css?v=2.0.2" rel="stylesheet" />
</head>
<body class="g-sidenav-show bg-gray-100">
    <div class="position-absolute w-100 min-height-300 top-0 bg-gradient-success">
        <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-5 text-center mx-auto">
            <h2 class="text-white mb-2 mt-5"><i class="fas fa-file-medical"></i> Medical Records</h2>
            <p class="text-lead text-white">You can search for the Out Patient Record file (OPD) Cards of any patient in this section.</p>
          </div>
        </div>
      </div>
  </div>
 <aside class="sidenav bg-white navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-4 " id="sidenav-main">
    <div class="sidenav-header text-center mt-4">
      <i class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
      <a href="/" class="text-center">
       <img src="/assets/img/logofinal.png" alt="logo" height="90px" width="90px" class="shadow-lg rounded-circle">
      </a>
    </div>
    <hr class="horizontal dark mt-4">
    <div class="collapse navbar-collapse w-auto " id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/dashboard">
            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
              <i class="ni ni-tv-2 text-success text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Dashboard</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs font-weight-bolder opacity-6">Medical History</h6>
        </li>
        {{#doctor}}
        <li class="nav-item">
          <a class="nav-link" href="/dashboard/incomingVisits/{{D_ID}}">
            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
              <i class="ni ni-single-copy-04 text-success text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Incoming Visits</span>
          </a>
        </li>
        {{/doctor}}
        <li class="nav-item">
          <a class="nav-link active " href="/dashboard/searchOPDdetails">
            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
              <i class="ni ni-books text-success text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Medical Records</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="sidenav-footer mx-3 ">
      <div class="card card-plain shadow-none" id="sidenavCard">
        <img class="w-50" src="/assets/img/doctordashboard.png" alt="sidebar_illustration" style="margin-left: 2.5rem;">
        <div class="card-body text-center p-3 w-100 pt-0">
          <div class="docs-info">
            <h6 class="mb-0">Clinic hours completed?</h6>
            
          </div>
        </div>
      </div> 
      <form action="/logout" method="POST">
              <button class="btn btn-dark btn-sm mb-0 w-100">Logout</button>
      </form>
    </div>
  </aside>
  <div class="main-content position-relative max-height-vh-100 h-100">
    <div class="card shadow-lg mx-4 card-profile-bottom">
      <div class="card-body p-3">
        <div class="row gx-4">
          <div class="col-auto my-auto">
            <div class="h-100">
            <div class="container-fluid py-4">
      <div class="row">
          <nav aria-label="breadcrumb mt-0">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="/dashboard/searchOPDdetails">Medical History</a></li>
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="javascript:history.back()">OPD Card detail</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Visit Details</li>
          </ol>
        </nav>
        <h3>Patient Visit Details</h3>
        {{#mesg1}}
        <div class='mt-8 ml-8 border border-gray-600 rounded-md bg-teal-200 text-center'>
            <p><b>Log the health status</b></p>

            <form action="{{Visit_No}}/addVisitDetails" method="POST">
                <label for="bp">BP</label>
                <input type="text" name="bp" id="bp" pattern="^\d{1,3}\/\d{1,3}$" title="e.g. 120/80"> mm HG <br> <br>

                <label for="pulse">Pulse Rate</label>
                <input type="text" name="pulse" id="pulse" pattern="^[0-9]{2,3}$" title="Should be 2 digit or 3 digit numeric value"> bpm <br> <br>

                <label for="temp">Body Temperature</label>
                <input type="text" name="temp" id="temp" pattern="\d{1,3}\.\d{1,3}?" title="e.g. 98.8, 100.4"> &#176; F <br> <br>

                <label for="sympExp">Symptoms experienced by the patient</label> <br>
                <textarea id="sympExp" name="sympExp" rows="4" cols="50"></textarea> <br> <br>

                <label for="diagnosis">Diagnosis</label> <br>
                <textarea id="diagnosis" name="diagnosis" rows="4" cols="50"></textarea> <br> <br>

                <div id="container">
                    <label for="labtests">Required Lab Tests</label> <br>
                    <input type="text" name="1" id="labtests">
                    <a class="text-gray-50  hover:bg-red-700 bg-red-500 px-5 py-3 mt-6" id="add">Add</a> <br>
                    <br>
                </div>

                <p>Medicine prescriptions</p>

                <div id="prescriptionContainer">
                <div class="mt-7 border border-gray-600 rounded-md" id="pres">
                    <label for="medName">Medicine Name</label> 
                    <input type="text" name="medName" id="medName"> 

                    <label for="desc">Description</label> 
                    <input type="text" name="desc" id="desc"> 

                    <label for="days">Days</label> 
                    <input type="text" name="days" id="days"  pattern="^[0-9]+$" title="Please enter numeric value only"> 

                    <label for="duration">Duration</label> 
                    <input type="text" name="duration" id="duration"  pattern="^[0-9]+$" title="Please enter numeric value only">
                </div>
                <a class="text-gray-50 hover:bg-red-700 bg-red-500 px-5 py-3 mt-6" id="presAdd">Add</a> <br>
                    <br>
                </div>

                <button class="text-gray-50  hover:bg-sky-700 bg-sky-500 px-5 py-3 mt-6">Save</button>
            </form>
        </div>
        {{/mesg1}}

        {{#mesg2}}
        <div class="card" style="width: 55rem; margin-top: 1rem">
        <div class="card-body">
              <h5 class="card-title"> <i class="far fa-file-alt text-success"></i> Visit Details</h5>
              <hr class="dark mt-1">
              <p class="card-text">Visit No: {{Visit_No}}</p>
              <p class="card-text">Visit Date: {{Visit_Date}}</p>
              <h5 class="card-title"><i class="fas fa-stethoscope text-success"></i> Vitals</h5>
              <hr class="dark mt-1">
              <p class="card-text">BP: {{BP}}</p>
              <p class="card-text">Pulse rate: {{Pulse}}</p>
            <p class="card-text">Body temperature: {{Temperature}}</p>
            <p class="card-text">Symptoms Experienced: {{Symptoms_Exp}}</p>
            <p class="card-text">Diagnosis: {{Diagnosis}}</p>
        </div>
        </div>
        {{/mesg2}}

        {{#mesg5}}
         <h5 class="card-title mt-3">Lab Test Details</h5>
        <hr class="dark mt-1">
        {{/mesg5}}
        
        {{#mesg3}}
        <div class="card" style="width: 55rem; margin-top: 1rem">
        <div class="card-body">
              <h5 class="card-title"><i class="fas fa-vial text-success"></i> {{Test_Name}}</h5>
              <p class="card-text">Payment Status: {{Test_Pay_Status}}</p>
              <p class="card-text">Test Completed: {{Test_Done}}</p>
               {{#if (isAvailable File_Data) }}
                          <a class="btn btn-dark" href="/dashboard/incomingVisits/downloadLabReports/{{File_Data}}">{{File_Data}}</a>
                {{else}}
                          <p class="card-text">Report: {{File_Data}}</p>
                {{/if}}
        </div>
        </div>
        {{/mesg3}}

        {{#mesg5}}
        <h5 class="card-title mt-3">Medicine Details</h5>
        <hr class="dark mt-1">
        {{/mesg5}}

        {{#mesg4}}
        <div class="card" style="width: 55rem; margin-top: 1rem">
        <div class="card-body">
              <h5 class="card-title"><i class="fas fa-pills text-success"></i> {{Medicine_Name}}</h5>
              <p class="card-text">Description: {{Description}}</p>
              <p class="card-text">Prescribed for <b>{{Days}}</b> days.</p>
               <p class="card-text">To be taken in the duration of <b>{{Duration}}</b> Hours.</p>
                <p class="card-text">Payment Status: {{Med_Pay_Status}}</p>
                 <p class="card-text">Medicine Received: {{Received}}</p>
              
        </div>
        </div>
        {{/mesg4}}

        {{#mesg8}}
         <div class="col-md-8">
          <div class="card" style="width: 55rem; margin-top: 1rem">
            <div class="card-body text-center">
              <i class="fas fa-file-medical-alt text-success" style="font-size: 4rem; margin-bottom:1rem;"></i>
              <p class="card-text">Nothing to display for now! <br> Please come back later.</p>
            </div>
          </div>
        </div>
        {{/mesg8}}
    <script>
        let addBtn = document.getElementById('add');
        let addBtnPres = document.getElementById('presAdd');
        addBtn.addEventListener('click', addTests);
        addBtnPres.addEventListener('click', addPrescriptions);
        //let cancelBtn = document.getElementById('cancelBtn');
        //cancelBtn.addEventListener('click', function(event){
          //  console.log(event.target.previousElementSibling);    
        //});
        function addTests() {
            var firstInput = document.getElementById('labtests');
            firstInput.setAttribute("required", "true");

            var container = document.getElementById("container");
            container.removeChild(addBtn);

            var inputArrays = [...document.querySelectorAll('#labtests')].pop();
            var number = parseInt(inputArrays.name);

            var input = document.createElement("input");
            input.type = "text";
            input.name = number + 1;
            input.id = "labtests";
            input.classList.add("mt-7");
            input.setAttribute("required", "true");
            var breakTag = document.createElement("br");
            var cancelBtn = document.createElement("a");
            cancelBtn.innerHTML = "Cancel";
            //cancelBtn.href = "#";
            cancelBtn.id = "cancelBtn";

            container.appendChild(input);
            container.appendChild(cancelBtn);
            container.appendChild(breakTag);
            container.appendChild(addBtn);
            container.appendChild(breakTag);
        }

        function addPrescriptions() {
            var medInput = document.getElementById('medName').setAttribute("required", "true");
            var descInput = document.getElementById('desc').setAttribute("required", "true");
            var daysInput = document.getElementById('days').setAttribute("required", "true");
            var durationInput = document.getElementById('duration').setAttribute("required", "true");

            var prescriptionContainer = document.getElementById("prescriptionContainer");
            prescriptionContainer.removeChild(addBtnPres);

            var inputArrays = [...document.querySelectorAll('#pres')].pop();
            var number = parseInt(inputArrays.name);

            //
            var container = document.createElement("div");
            container.id = "pres";
            container.classList.add('mt-7','border','border-gray-600','rounded-md');
            //
            var cancelBtn = document.createElement("a");
            cancelBtn.innerHTML = "Cancel";
            //cancelBtn.href = "#";
            cancelBtn.id = "cancelBtn";
            //
            var medNameLbl = document.createElement("label");
            medNameLbl.innerHTML = "Medicine Name";
            var medNameInput = document.createElement("input");
            medNameInput.name = "medName";
            medNameInput.id = "medInput";
            medNameInput.setAttribute("required", "true");

            var descLbl = document.createElement("label");
            descLbl.innerHTML = "Description";
            var descInput = document.createElement("input");
            descInput.name = "desc";
            descInput.id = "desc";
            descInput.setAttribute("required", "true");

            var daysLbl = document.createElement("label");
            daysLbl.innerHTML = "Days";
            var daysInput = document.createElement("input");
            daysInput.name = "days";
            daysInput.id = "days";
            daysInput.pattern = "^[0-9]+$";
            daysInput.title = "Please enter numeric value only";
            daysInput.setAttribute("required", "true");

            var durationLbl = document.createElement("label");
            durationLbl.innerHTML = "Duration";
            var durationInput = document.createElement("input");
            durationInput.name = "duration";
            durationInput.id = "duration";
            durationInput.pattern = "^[0-9]+$";
            durationInput.title = "Please enter numeric value only";
            durationInput.setAttribute("required", "true");


            //

            prescriptionContainer.appendChild(container);
            container.appendChild(medNameLbl);
            container.appendChild(medNameInput);
            //container.appendChild(breakTag);

            container.appendChild(descLbl);
             container.appendChild(descInput);
            //container.appendChild(breakTag);

            container.appendChild(daysLbl);
             container.appendChild(daysInput);
            //container.appendChild(breakTag);

            container.appendChild(durationLbl);
             container.appendChild(durationInput);
            //container.appendChild(breakTag);

            //
            prescriptionContainer.appendChild(cancelBtn);
           prescriptionContainer.appendChild(addBtnPres);
        }
    </script>
         </div>
        </div>
    </div>
      </div>
    </div>
            </div>
          </div>  
        </div>
      </div>
    </div>
  </div>
  <div class="fixed-plugin">
    <a class="fixed-plugin-button text-dark position-fixed px-3 py-2" href="/">
     <i class="fas fa-clinic-medical py-2"></i>
    </a>
  </div>
  <!--   Core JS Files   -->
  <script src="/assets/js/core/popper.min.js"></script>
  <script src="/assets/js/core/bootstrap.min.js"></script>
  <script src="/assets/js/plugins/perfect-scrollbar.min.js"></script>
  <script src="/assets/js/plugins/smooth-scrollbar.min.js"></script>
  <script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
  </script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="/assets/js/argon-dashboard.min.js?v=2.0.2"></script>
</body>
</html>